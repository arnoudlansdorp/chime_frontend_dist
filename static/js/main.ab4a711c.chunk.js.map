{"version":3,"sources":["config.js","components/chime/ChimeSdkWrapper.js","components/chimeWeb/Error.jsx","assets/Logo.svg","components/chimeWeb/Alert.jsx","components/chimeWeb/Welcome.jsx","components/chimeWeb/Join.jsx","assets/RaiseBtn/Raise-Hand.svg","assets/svgs/close.svg","assets/svgs/un-line.svg","components/chat/Chat.jsx","assets/svgs/mute.svg","assets/svgs/camera.svg","assets/svgs/share.svg","assets/svgs/hand.svg","assets/svgs/qa.svg","assets/svgs/qaa.svg","assets/svgs/user.svg","assets/svgs/usera.svg","components/chimeWeb/Controls.jsx","components/chimeWeb/Settings.jsx","components/chimeWeb/LocalVideo.jsx","components/chimeWeb/RemoteVideo.jsx","components/chimeWeb/RemoteVideoGroup.jsx","assets/UoL.svg","assets/svgs/v-icon.svg","components/chimeWeb/Meeting.jsx","components/chimeWeb/End.jsx","components/App.js","serviceWorker.js","index.js"],"names":["CHIME_ROOM_API","CHAT_WEBSOCKET","DEBUG","ChimeSdkWrapper","this","initializeSdkWrapper","meetingSession","audioVideo","title","name","region","currentAudioInputDevice","currentAudioOutputDevice","currentVideoInputDevice","audioInputDevices","audioOutputDevices","videoInputDevices","devicesUpdatedCallbacks","roster","rosterUpdateCallbacks","configuration","messagingSocket","messageUpdateCallbacks","error","console","role","playbackURL","a","payload","fetch","config","method","body","JSON","stringify","response","json","Error","JoinInfo","MeetingSessionConfiguration","Meeting","Attendee","initializeMeetingSession","Title","logger","ConsoleLogger","LogLevel","ERROR","deviceController","DefaultDeviceController","DefaultMeetingSession","listAudioInputDevices","forEach","mediaDeviceInfo","push","label","value","deviceId","listAudioOutputDevices","listVideoInputDevices","publishDevicesUpdated","addDeviceChangeObserver","realtimeSubscribeToAttendeeIdPresence","presentAttendeeId","present","publishRosterUpdate","realtimeSubscribeToVolumeIndicator","attendeeId","volume","muted","signalStrength","DefaultModality","base","Math","round","encodeURIComponent","AttendeeInfo","Name","element","logError","window","addEventListener","event","reason","audioInputs","length","chooseAudioInputDevice","audioOutputs","chooseAudioOutputDevice","videoInputs","chooseVideoInputDevice","bindAudioElement","start","messagingUrl","meetingId","credentials","joinToken","ReconnectingPromisedWebSocket","DefaultPromisedWebSocketFactory","DefaultDOMWebSocketFactory","FullJitterBackoff","open","WEB_SOCKET_TIMEOUT_MS","data","parse","publishMessageUpdate","type","timestampMs","Date","now","message","send","end","stop","device","freshAudioInputDeviceList","hasCurrentDevice","freshAudioOutputDeviceList","freshVideoInputDeviceList","callback","index","indexOf","splice","throttle","i","ROSTER_THROTTLE_MS","handleKeyDown","e","keyCode","props","closeError","handleClick","node","target","isModal","classList","contains","parentNode","handleGoCreateRoom","location","replace","document","removeEventListener","className","onClick","viewBox","xmlns","d","errorMsg","Component","Alert","src","logo","alt","href","rel","withRouter","Welcome","state","username","showError","isAvailable","handleNameChange","setState","handleRoomChange","handlePlaybackURLChange","handleCreateRoom","preventDefault","stopPropagation","createRoom","setErrorMsg","baseHref","inputRef","React","createRef","qs","URLSearchParams","search","get","history","current","focus","navigator","mediaDevices","enumerateDevices","log","userAgent","test","MSStream","sessionStorage","setItem","createRoomDisabled","Fragment","action","placeholder","ref","onChange","disabled","Join","joinRoom","handleJoinRoom","room","joinRoomDisabled","Chat","rosterCallback","newRoster","keys","Object","participants","parts","map","key","joinInfo","AttendeeId","item","mute","host","scrollToBottom","handleChange","str","connection","handleSendMobile","handleRoomClick","link","origin","pathname","copyTextToClipboard","encodeURI","setShowPopup","showPopup","setTimeout","text","clipboard","writeText","then","err","parseUrls","userInput","match","formattedMatch","startsWith","renderMessages","messages","formattedMessage","dangerouslySetInnerHTML","__html","data-tip","data-for","handleUpVote","id","place","effect","vote","timestamp","handleTabChange","changeTab","renderParticipants","participant","RaiseHandIcon","unIcon","tabIndex","chatRef","messagesEndRef","initChatConnection","chime","subscribeToRosterUpdate","MeetingId","JoinToken","messageData","Type","MessageId","Time","Sender","Content","Vote","isChrome","isIOS","iosChromeClassForInput","iosChromeClassForMessages","closeChat","closeIcon","onSelect","selectedIndex","isChat","maxLength","rows","onKeyDown","Controls","videoStatus","handRaiseStatus","shareScreenStatue","openChatStatus","openParticipantsStatus","localMuted","muteButtonOnClick","realtimeUnmuteLocalAudio","realtimeMuteLocalAudio","Promise","resolve","raiseButtonOnClick","shareButtonOnClick","stopContentShare","startContentShareFromScreenCapture","videoButtonOnClick","selectedDevice","toLowerCase","includes","startLocalVideoTile","stopLocalVideoTile","endButtonOnClick","leaveRoom","removeItem","ssName","whereTo","toggleChat","openChat","togglePT","openPT","realtimeSubscribeToMuteAndUnmuteLocalAudio","realtimeUnsubscribeToMuteAndUnmuteLocalAudio","mic_controls","cam_controls","hand_controls","share_controls","muteIcon","cameraIcon","shareIcon","handIcon","isOpenChat","qaaIcon","qaIcon","useraIcon","userIcon","openSettings","Settings","microphone","speaker","camera","devicesUpdatedCallback","fullDeviceInfo","closeSettings","handleMicrophoneChange","o","handleSpeakerChange","handleCameraChange","handleSave","saveSettings","renderDevices","devices","defaultValue","subscribeToDevicesUpdated","unsubscribeFromDevicesUpdated","currentMic","currentSpeaker","currentCam","availableMics","availableSpeakers","availableCams","readOnly","PlaybackURL","LocalVideo","enabled","showMeta","videoElement","addObserver","videoTileDidUpdate","tileState","boundAttendeeId","localTile","tileId","bindVideoElement","active","unsubscribeFromRosterUpdate","onMouseEnter","handleMouseEnter","bind","onMouseLeave","handleMouseLeave","RemoteVideo","camClass","videoId","count","RemoteVideoGroup","rosterChanged","shareVideoElement","isMyContent","isSharingContent","sharingTileId","sharingInfo","findRosterSlot","previousRoster","differ","filter","k","assign","attendee","videoTileDidUpdateCallback","isContent","getElementById","videoEnabled","videoTileWasRemovedCallback","find","stopHandle","Array","from","videoTileWasRemoved","meetingStatus","showSettings","showPopupMessage","showModal","changeChat","hideModal","setMetadataId","metadataId","layout","bodylogo","myVideoElement","vicon","audioElementRef","getItem","ssData","reInitializeMeetingSession","audioVideoDidStop","sessionStatus","statusCode","MeetingSessionStatusCode","AudioCallEnded","style","display","End","App","path","Boolean","hostname","ReactDOM","render","StrictMode","serviceWorker","ready","registration","unregister","catch","vh","innerHeight","documentElement","setProperty"],"mappings":"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","file":"static/js/main.ab4a711c.chunk.js","sourcesContent":["export const BASE_HREF = \"\";\r\n\r\n// API endpoint for retrieving the attendees list, joining the room, and ending the room\r\nexport const CHIME_ROOM_API = \"https://m7qxs56fx5.execute-api.us-east-1.amazonaws.com/Prod\";\r\n\r\n// Chime-SDK allows up to 16 attendee videos\r\nexport const CHIME_ROOM_MAX_ATTENDEE = 10;\r\n\r\n// Default video stream to play inside the video player\r\nexport const DEFAULT_VIDEO_STREAM = \"https://fcc3ddae59ed.us-west-2.playback.live-video.net/api/video/v1/us-west-2.893648527354.channel.DmumNckWFTqz.m3u8\";\r\n\r\n// Default Chat websocket link\r\nexport const CHAT_WEBSOCKET = \"wss://5sg50im573.execute-api.us-east-1.amazonaws.com/Prod\";\r\n\r\n// Chime-SDK logging level: INFO, WARN, ERROR, DEBUG\r\nexport const CHIME_LOG_LEVEL = 'WARN';\r\n\r\n// Chime-Web UI debugging logging: true / false\r\nexport const DEBUG = false;\r\n\r\n","import {\r\n  ConsoleLogger,\r\n  DefaultDeviceController,\r\n  DefaultDOMWebSocketFactory,\r\n  DefaultMeetingSession,\r\n  DefaultModality,\r\n  DefaultPromisedWebSocketFactory,\r\n  FullJitterBackoff,\r\n  LogLevel,\r\n  MeetingSessionConfiguration,\r\n  ReconnectingPromisedWebSocket\r\n} from 'amazon-chime-sdk-js';\r\n\r\nimport throttle from 'lodash/throttle';\r\nimport * as config from '../../config';\r\n\r\n\r\nexport default class ChimeSdkWrapper {\r\n\r\n  static WEB_SOCKET_TIMEOUT_MS = 10000;\r\n  static ROSTER_THROTTLE_MS = 400;\r\n\r\n  constructor() {\r\n    this.initializeSdkWrapper();\r\n  }\r\n\r\n  initializeSdkWrapper() {\r\n    this.meetingSession = null;\r\n    this.audioVideo = null;\r\n    this.title = null;\r\n    this.name = null;\r\n    this.region = null;\r\n    this.currentAudioInputDevice = null;\r\n    this.currentAudioOutputDevice = null;\r\n    this.currentVideoInputDevice = null;\r\n    this.audioInputDevices = [];\r\n    this.audioOutputDevices = [];\r\n    this.videoInputDevices = [];\r\n    this.devicesUpdatedCallbacks = [];\r\n    this.roster = {};\r\n    this.rosterUpdateCallbacks = [];\r\n    this.configuration = null;\r\n    this.messagingSocket = null;\r\n    this.messageUpdateCallbacks = [];\r\n  }\r\n\r\n  logError(error) {\r\n    console.error(error);\r\n  }\r\n\r\n  async createRoom(role, name, title, playbackURL, region) {\r\n    if (!name || !title || !role) {\r\n      console.error(\r\n           `role=${role} name=${name} title=${title} must exist`\r\n      );\r\n      return;\r\n    }\r\n\r\n    const payload = {\r\n      name,\r\n      title,\r\n      playbackURL,\r\n      role\r\n    };\r\n\r\n    const response = await fetch(\r\n      `${config.CHIME_ROOM_API}/join`,\r\n      {\r\n        method: 'POST',\r\n        body: JSON.stringify(payload)\r\n      }\r\n    );\r\n    const json = await response.json();\r\n    if (json.error) {\r\n      throw new Error(\r\n        json.error\r\n      );\r\n    }\r\n\r\n    const { JoinInfo } = json;\r\n    if (!JoinInfo) {\r\n      throw new Error(\r\n        'CreateOrJoin.classRoomDoesNotExist'\r\n      );\r\n    }\r\n    this.configuration = new MeetingSessionConfiguration(\r\n      JoinInfo.Meeting,\r\n      JoinInfo.Attendee\r\n    );\r\n    await this.initializeMeetingSession(this.configuration);\r\n\r\n    this.title = title;\r\n    this.name = name;\r\n    this.region = region;\r\n\r\n    return JoinInfo;\r\n  }\r\n\r\n  async reInitializeMeetingSession(JoinInfo, name) {\r\n    this.configuration = new MeetingSessionConfiguration(\r\n      JoinInfo.Meeting,\r\n      JoinInfo.Attendee\r\n    );\r\n    await this.initializeMeetingSession(this.configuration);\r\n\r\n    this.title = JoinInfo.Title;\r\n    this.name = name;\r\n    // this.region = region;\r\n  }\r\n\r\n  async initializeMeetingSession(configuration) {\r\n    const logger = new ConsoleLogger('SDK', LogLevel.ERROR);\r\n    const deviceController = new DefaultDeviceController(logger);\r\n    this.meetingSession = new DefaultMeetingSession(\r\n      configuration,\r\n      logger,\r\n      deviceController\r\n    );\r\n    this.audioVideo = this.meetingSession.audioVideo;\r\n\r\n    this.audioInputDevices = [];\r\n    (await this.audioVideo.listAudioInputDevices()).forEach(\r\n      (mediaDeviceInfo) => {\r\n        this.audioInputDevices.push({\r\n          label: mediaDeviceInfo.label,\r\n          value: mediaDeviceInfo.deviceId\r\n        });\r\n      }\r\n    );\r\n    this.audioOutputDevices = [];\r\n    (await this.audioVideo.listAudioOutputDevices()).forEach(\r\n      (mediaDeviceInfo) => {\r\n        this.audioOutputDevices.push({\r\n          label: mediaDeviceInfo.label,\r\n          value: mediaDeviceInfo.deviceId\r\n        });\r\n      }\r\n    );\r\n    this.videoInputDevices = [];\r\n    (await this.audioVideo.listVideoInputDevices()).forEach(\r\n      (mediaDeviceInfo) => {\r\n        this.videoInputDevices.push({\r\n          label: mediaDeviceInfo.label,\r\n          value: mediaDeviceInfo.deviceId\r\n        });\r\n      }\r\n    );\r\n    this.publishDevicesUpdated();\r\n    this.audioVideo.addDeviceChangeObserver(this);\r\n\r\n    this.audioVideo.realtimeSubscribeToAttendeeIdPresence(\r\n      (presentAttendeeId, present) => {\r\n        if (!present) {\r\n          delete this.roster[presentAttendeeId];\r\n          //this.publishRosterUpdate.cancel();\r\n          this.publishRosterUpdate()();\r\n          return;\r\n        }\r\n\r\n        this.audioVideo.realtimeSubscribeToVolumeIndicator(\r\n          presentAttendeeId,\r\n          async (\r\n            attendeeId,\r\n            volume,\r\n            muted,\r\n            signalStrength\r\n          ) => {\r\n            const baseAttendeeId = new DefaultModality(attendeeId).base();\r\n            if (baseAttendeeId !== attendeeId) {\r\n              // Don't include the content attendee in the roster.\r\n              //\r\n              // When you or other attendees share content (a screen capture, a video file,\r\n              // or any other MediaStream object), the content attendee (attendee-id#content) joins the session and\r\n              // shares content as if a regular attendee shares a video.\r\n              //\r\n              // For example, your attendee ID is \"my-id\". When you call meetingSession.audioVideo.startContentShare,\r\n              // the content attendee \"my-id#content\" will join the session and share your content.\r\n              return;\r\n            }\r\n\r\n            let shouldPublishImmediately = false;\r\n\r\n            if (!this.roster[attendeeId]) {\r\n              this.roster[attendeeId] = { name: '' };\r\n            }\r\n            if (volume !== null) {\r\n              this.roster[attendeeId].volume = Math.round(volume * 100);\r\n            }\r\n            if (muted !== null) {\r\n              this.roster[attendeeId].muted = muted;\r\n            }\r\n            if (signalStrength !== null) {\r\n              this.roster[attendeeId].signalStrength = Math.round(\r\n                signalStrength * 100\r\n              );\r\n            }\r\n            if (this.title && attendeeId && !this.roster[attendeeId].name) {\r\n              const response = await fetch(\r\n                `${config.CHIME_ROOM_API}/attendee?title=${encodeURIComponent(\r\n                  this.title\r\n                )}&attendeeId=${encodeURIComponent(attendeeId)}`\r\n              );\r\n              const json = await response.json();\r\n              if (json.AttendeeInfo && this.roster[attendeeId]) {\r\n                this.roster[attendeeId].name = json.AttendeeInfo.Name || '';\r\n                shouldPublishImmediately = true;\r\n              }\r\n            }\r\n\r\n            if (shouldPublishImmediately) {\r\n              //this.publishRosterUpdate.cancel();\r\n            }\r\n            this.publishRosterUpdate()();\r\n          }\r\n        );\r\n      }\r\n    );\r\n  }\r\n\r\n  async joinRoom(element) {\r\n    if (!element) {\r\n      this.logError(new Error(`element does not exist`));\r\n      return;\r\n    }\r\n\r\n    window.addEventListener(\r\n      'unhandledrejection',\r\n      (event) => {\r\n        this.logError(event.reason);\r\n      }\r\n    );\r\n\r\n    const audioInputs = await this.audioVideo.listAudioInputDevices();\r\n    if (audioInputs && audioInputs.length > 0 && audioInputs[0].deviceId) {\r\n      this.currentAudioInputDevice = {\r\n        label: audioInputs[0].label,\r\n        value: audioInputs[0].deviceId\r\n      };\r\n      await this.audioVideo.chooseAudioInputDevice(audioInputs[0].deviceId);\r\n    }\r\n\r\n    const audioOutputs = await this.audioVideo.listAudioOutputDevices();\r\n    if (audioOutputs && audioOutputs.length > 0 && audioOutputs[0].deviceId) {\r\n      this.currentAudioOutputDevice = {\r\n        label: audioOutputs[0].label,\r\n        value: audioOutputs[0].deviceId\r\n      };\r\n      await this.audioVideo.chooseAudioOutputDevice(audioOutputs[0].deviceId);\r\n    }\r\n\r\n    const videoInputs = await this.audioVideo.listVideoInputDevices();\r\n    if (videoInputs && videoInputs.length > 0 && videoInputs[0].deviceId) {\r\n      this.currentVideoInputDevice = {\r\n        label: videoInputs[0].label,\r\n        value: videoInputs[0].deviceId\r\n      };\r\n      await this.audioVideo.chooseVideoInputDevice(null);\r\n    }\r\n\r\n    this.publishDevicesUpdated();\r\n\r\n    this.audioVideo.bindAudioElement(element);\r\n    this.audioVideo.start();\r\n  }\r\n\r\n  async joinRoomMessaging() {\r\n    if (!this.configuration) {\r\n      this.logError(new Error('configuration does not exist'));\r\n      return;\r\n    }\r\n\r\n    const messagingUrl = `${config.CHAT_WEBSOCKET}?MeetingId=${this.configuration.meetingId}&AttendeeId=${this.configuration.credentials.attendeeId}&JoinToken=${this.configuration.credentials.joinToken}`;\r\n    this.messagingSocket = new ReconnectingPromisedWebSocket(\r\n      messagingUrl,\r\n      [],\r\n      'arraybuffer',\r\n      new DefaultPromisedWebSocketFactory(new DefaultDOMWebSocketFactory()),\r\n      new FullJitterBackoff(1000, 0, 10000)\r\n    );\r\n\r\n    await this.messagingSocket.open(this.WEB_SOCKET_TIMEOUT_MS);\r\n\r\n    this.messagingSocket.addEventListener('message', (event) => {\r\n      try {\r\n        const data = JSON.parse(event.data);\r\n        const { attendeeId } = data.payload;\r\n\r\n        let name;\r\n        if (this.roster[attendeeId]) {\r\n          name = this.roster[attendeeId].name;\r\n        }\r\n\r\n        this.publishMessageUpdate({\r\n          type: data.type,\r\n          payload: data.payload,\r\n          timestampMs: Date.now(),\r\n          name\r\n        });\r\n      } catch (error) {\r\n        this.logError(error);\r\n      }\r\n    });\r\n  }\r\n\r\n  sendMessage(type, payload) {\r\n    if (!this.messagingSocket) {\r\n      return;\r\n    }\r\n    const message = {\r\n      message: 'sendmessage',\r\n      data: JSON.stringify({ type, payload })\r\n    };\r\n    try {\r\n      this.messagingSocket.send(JSON.stringify(message));\r\n    } catch (error) {\r\n      this.logError(error);\r\n    }\r\n  }\r\n\r\n  async leaveRoom(end) {\r\n    try {\r\n      this.audioVideo.stop();\r\n    } catch (error) {\r\n      this.logError(error);\r\n    }\r\n\r\n    // try {\r\n    //   await this.messagingSocket.close(this.WEB_SOCKET_TIMEOUT_MS);\r\n    // } catch (error) {\r\n    //   this.logError(error);\r\n    // }\r\n\r\n    try {\r\n      if (end && this.title) {\r\n        await fetch(\r\n          `${config.CHIME_ROOM_API}/end?title=${encodeURIComponent(this.title)}`,\r\n          {\r\n            method: 'POST'\r\n          }\r\n        );\r\n      }\r\n    } catch (error) {\r\n      this.logError(error);\r\n    }\r\n\r\n    this.initializeSdkWrapper();\r\n  }\r\n\r\n  // Device\r\n\r\n  async chooseAudioInputDevice(device) {\r\n    try {\r\n      await this.audioVideo.chooseAudioInputDevice(device.value);\r\n      this.currentAudioInputDevice = device;\r\n    } catch (error) {\r\n      this.logError(error);\r\n    }\r\n  }\r\n\r\n  async chooseAudioOutputDevice(device) {\r\n    try {\r\n      await this.audioVideo.chooseAudioOutputDevice(device.value);\r\n      this.currentAudioOutputDevice = device;\r\n    } catch (error) {\r\n      this.logError(error);\r\n    }\r\n  }\r\n\r\n  async chooseVideoInputDevice(device) {\r\n    try {\r\n      await this.audioVideo.chooseVideoInputDevice(device.value);\r\n      this.currentVideoInputDevice = device;\r\n    } catch (error) {\r\n      this.logError(error);\r\n    }\r\n  }\r\n\r\n  // Observer methods\r\n\r\n  audioInputsChanged(freshAudioInputDeviceList) {\r\n    let hasCurrentDevice = false;\r\n    this.audioInputDevices = [];\r\n    freshAudioInputDeviceList.forEach((mediaDeviceInfo) => {\r\n      if (\r\n        this.currentAudioInputDevice &&\r\n        mediaDeviceInfo.deviceId === this.currentAudioInputDevice.value\r\n      ) {\r\n        hasCurrentDevice = true;\r\n      }\r\n      this.audioInputDevices.push({\r\n        label: mediaDeviceInfo.label,\r\n        value: mediaDeviceInfo.deviceId\r\n      });\r\n    });\r\n    if (!hasCurrentDevice) {\r\n      this.currentAudioInputDevice =\r\n        this.audioInputDevices.length > 0 ? this.audioInputDevices[0] : null;\r\n    }\r\n    this.publishDevicesUpdated();\r\n  }\r\n\r\n  audioOutputsChanged(freshAudioOutputDeviceList) {\r\n    let hasCurrentDevice = false;\r\n    this.audioOutputDevices = [];\r\n    freshAudioOutputDeviceList.forEach((mediaDeviceInfo) => {\r\n      if (\r\n        this.currentAudioOutputDevice &&\r\n        mediaDeviceInfo.deviceId === this.currentAudioOutputDevice.value\r\n      ) {\r\n        hasCurrentDevice = true;\r\n      }\r\n      this.audioOutputDevices.push({\r\n        label: mediaDeviceInfo.label,\r\n        value: mediaDeviceInfo.deviceId\r\n      });\r\n    });\r\n    if (!hasCurrentDevice) {\r\n      this.currentAudioOutputDevice =\r\n        this.audioOutputDevices.length > 0 ? this.audioOutputDevices[0] : null;\r\n    }\r\n    this.publishDevicesUpdated();\r\n  }\r\n\r\n  videoInputsChanged(freshVideoInputDeviceList) {\r\n    let hasCurrentDevice = false;\r\n    this.videoInputDevices = [];\r\n    freshVideoInputDeviceList.forEach((mediaDeviceInfo) => {\r\n      if (\r\n        this.currentVideoInputDevice &&\r\n        mediaDeviceInfo.deviceId === this.currentVideoInputDevice.value\r\n      ) {\r\n        hasCurrentDevice = true;\r\n      }\r\n      this.videoInputDevices.push({\r\n        label: mediaDeviceInfo.label,\r\n        value: mediaDeviceInfo.deviceId\r\n      });\r\n    });\r\n    if (!hasCurrentDevice) {\r\n      this.currentVideoInputDevice =\r\n        this.videoInputDevices.length > 0 ? this.videoInputDevices[0] : null;\r\n    }\r\n    this.publishDevicesUpdated();\r\n  }\r\n\r\n  // Subscribe and unsubscribe\r\n\r\n  subscribeToDevicesUpdated(callback) {\r\n    this.devicesUpdatedCallbacks.push(callback);\r\n  }\r\n\r\n  unsubscribeFromDevicesUpdated(callback) {\r\n    const index = this.devicesUpdatedCallbacks.indexOf(callback);\r\n    if (index !== -1) {\r\n      this.devicesUpdatedCallbacks.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  publishDevicesUpdated() {\r\n    this.devicesUpdatedCallbacks.forEach(\r\n      (callback) => {\r\n        callback({\r\n          currentAudioInputDevice: this.currentAudioInputDevice,\r\n          currentAudioOutputDevice: this.currentAudioOutputDevice,\r\n          currentVideoInputDevice: this.currentVideoInputDevice,\r\n          audioInputDevices: this.audioInputDevices,\r\n          audioOutputDevices: this.audioOutputDevices,\r\n          videoInputDevices: this.videoInputDevices\r\n        });\r\n      }\r\n    );\r\n  }\r\n\r\n  subscribeToRosterUpdate(callback) {\r\n    this.rosterUpdateCallbacks.push(callback);\r\n  }\r\n\r\n  unsubscribeFromRosterUpdate(callback) {\r\n    const index = this.rosterUpdateCallbacks.indexOf(callback);\r\n    if (index !== -1) {\r\n      this.rosterUpdateCallbacks.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  publishRosterUpdate() {\r\n    return throttle(() => {\r\n      for (let i = 0; i < this.rosterUpdateCallbacks.length; i += 1) {\r\n        const callback = this.rosterUpdateCallbacks[i];\r\n        callback(this.roster);\r\n      }\r\n    }, this.ROSTER_THROTTLE_MS);\r\n  }\r\n\r\n  subscribeToMessageUpdate(callback) {\r\n    this.messageUpdateCallbacks.push(callback);\r\n  }\r\n\r\n  unsubscribeFromMessageUpdate(callback) {\r\n    const index = this.messageUpdateCallbacks.indexOf(callback);\r\n    if (index !== -1) {\r\n      this.messageUpdateCallbacks.splice(index, 1);\r\n    }\r\n  }\r\n\r\n  publishMessageUpdate(message) {\r\n    for (let i = 0; i < this.messageUpdateCallbacks.length; i += 1) {\r\n      const callback = this.messageUpdateCallbacks[i];\r\n      callback(message);\r\n    }\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Styles\r\nimport './Error.css';\r\n\r\n// Assets\r\n\r\nclass Error extends Component {\r\n\r\n  componentDidMount() {\r\n    document.addEventListener(\"keydown\", this.handleKeyDown);\r\n\r\n    // setTimeout(() => {\r\n    //   this.props.closeError();\r\n    // }, 10000);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"keydown\", this.handleKeyDown);\r\n  }\r\n\r\n  handleKeyDown = (e) => {\r\n    if (e.keyCode === 27) { // keyCode 27 is Escape key\r\n      this.props.closeError();\r\n    }\r\n  }\r\n\r\n  handleClick = (e) => {\r\n    let node = e.target;\r\n    let isModal = false;\r\n    while (node) {\r\n      if (node && node.classList && node.classList.contains('notice--error')) {\r\n        isModal = true;\r\n        break;\r\n      }\r\n      node = node.parentNode;\r\n    }\r\n    if (!isModal) {\r\n      this.props.closeError();\r\n    }\r\n  }\r\n\r\n  handleGoCreateRoom = () => {\r\n    window.location.replace(\"/index.html\");\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"notice notice--error\" onClick={this.handleClick}>\r\n        <div className=\"notice__content\">\r\n          <div className=\"icon icon--24 notice__icon\"><svg viewBox=\"0 0 1000 1000\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M 500 0C 224 0 0 224 0 500C 0 776 224 1000 500 1000C 776 1000 1000 776 1000 500C 1000 224 776 0 500 0C 500 0 500 0 500 0M 526 150C 576 150 602 175 601 224C 600 300 600 350 575 525C 570 560 560 575 525 575C 525 575 475 575 475 575C 440 575 430 560 425 525C 400 355 400 300 400 226C 400 175 425 150 475 150M 500 650C 527 650 552 661 571 679C 589 698 600 723 600 750C 600 805 555 850 500 850C 445 850 400 805 400 750C 400 723 411 698 429 679C 448 661 473 650 500 650C 500 650 500 650 500 650\"/></svg></div>\r\n          {this.props.errorMsg}\r\n          <div>To create your own room, click <span className=\"go-create-room\" onClick={this.handleGoCreateRoom}>here</span>.</div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nError.propTypes = {\r\n  errorMsg: PropTypes.string,\r\n  closeError: PropTypes.func\r\n};\r\n\r\nexport default Error;\r\n","export default __webpack_public_path__ + \"static/media/Logo.c65422c9.svg\";","import React, { Component } from \"react\";\nimport { withRouter } from \"react-router-dom\";\n\n// Styles\nimport \"./Alert.css\";\nimport logo from \"./../../assets/Logo.svg\";\n\nclass Alert extends Component {\n\n    render() {\n        return(\n        <div className={\"alert-container\"}>\n            <div className={\"alert-back-drop\"}>\n            </div>\n            <div className={\"alert-content\"}>\n                <img className=\"alert-logo\" src={logo} alt=\"Logo\" />\n                <p>Sorry, but we’ve detected that your browser or device is not compatible</p>\n                <p>with our virtual meeting software.</p>\n                <br/>\n                <p>Please try a different browser or device to access the session.</p>\n                <br/>\n                <p>For more details on compatibility options, <a target=\"_blank\" href=\"https://docs.aws.amazon.com/chime/latest/dg/meetings-sdk.html\" rel=\"noreferrer\">click here.</a></p>\n            </div>\n        </div>\n        );\n        \n    }\n}\n\nexport default withRouter(Alert);","import React, { Component } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport * as config from '../../config';\r\nimport Error from './Error';\r\nimport Alert from './Alert';\r\n\r\nclass Welcome extends Component {\r\n\r\n  state = {\r\n    role: 'host',\r\n    username: '',\r\n    title: '',\r\n    playbackURL: config.DEFAULT_VIDEO_STREAM,\r\n    errorMsg: '',\r\n    showError: false,\r\n    isAvailable: false,\r\n  }\r\n\r\n  constructor() {\r\n    super ();\r\n    this.baseHref = config.BASE_HREF;\r\n    this.inputRef = React.createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    const qs = new URLSearchParams(this.props.location.search);\r\n    const action = qs.get('action');\r\n    if (action === 'join') {\r\n      const title = qs.get('room');\r\n      this.props.history.push(`${this.baseHref}/join?room=${title}`);\r\n    }\r\n    this.inputRef.current.focus();\r\n    try{\r\n      if(!navigator.mediaDevices.enumerateDevices) {\r\n        this.setState({isAvailable: true});\r\n      }\r\n    } catch(e) {\r\n      console.log(e)\r\n      this.setState({isAvailable: true});\r\n    }\r\n    \r\n    const isChrome = navigator.userAgent.indexOf(\"Chrome\") !== 1;\r\n    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n    \r\n    if(isChrome & isIOS) {\r\n      this.setState({isAvailable: true});\r\n    }\r\n  }\r\n\r\n  handleNameChange = e => {\r\n    this.setState({ username: e.target.value })\r\n  }\r\n\r\n  handleRoomChange = e => {\r\n    this.setState({ title: e.target.value })\r\n  }\r\n\r\n  handlePlaybackURLChange = e => {\r\n    this.setState({ playbackURL: e.target.value })\r\n  }\r\n\r\n  handleCreateRoom = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    this.createRoom();\r\n  }\r\n\r\n  setErrorMsg = errorMsg => {\r\n    this.setState({ errorMsg, showError: true });\r\n  }\r\n\r\n  closeError = () => {\r\n    this.setState({ showError: false });\r\n  }\r\n\r\n  async createRoom() {\r\n    const { title, username, playbackURL } = this.state;\r\n    const data = {\r\n      username,\r\n      title,\r\n      playbackURL,\r\n      role: this.state.role\r\n    }\r\n    sessionStorage.setItem(`chime[${title}]`, JSON.stringify(data));\r\n    this.props.history.push(`${this.baseHref}/meeting?room=${title}&username=${username}`);\r\n  }\r\n\r\n  render() {\r\n    const { username, title, playbackURL, isAvailable } = this.state;\r\n    const createRoomDisabled = !username || !title || !playbackURL;\r\n    return (\r\n      <React.Fragment>\r\n        {isAvailable && <Alert />}\r\n        <div className=\"welcome form-grid\">\r\n\r\n          <div className=\"welcome__intro\">\r\n            <div className=\"intro__inner formatted-text\">\r\n              <h1>Amazon IVS with ChimeSDK</h1>\r\n              <h3>Create or join rooms, and watch Amazon IVS streams with anyone.</h3>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"welcome__content pd-4\">\r\n            <div className=\"content__inner\">\r\n              <h2 className=\"mg-b-2\">Get started</h2>\r\n              <form action=\"\">\r\n                <fieldset className=\"mg-b-2\">\r\n                  <input className=\"mg-b-2\" type=\"text\" placeholder=\"Your name\" value={username} ref={this.inputRef} onChange={this.handleNameChange} />\r\n                  <input type=\"text\" placeholder=\"Room name\" value={title} onChange={this.handleRoomChange} />\r\n                  <input type=\"hidden\" placeholder=\"Playback URL\" value={playbackURL} onChange={this.handlePlaybackURLChange} />\r\n                  <button className=\"mg-t-2 btn btn--primary\" disabled={createRoomDisabled} onClick={this.handleCreateRoom} >Create room</button>\r\n                </fieldset>\r\n              </form>\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n        {this.state.showError && (\r\n          <Error\r\n            closeError={this.closeError}\r\n            errorMsg={this.state.errorMsg}\r\n          />\r\n        )}\r\n      </React.Fragment>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(Welcome);\r\n","import React, { Component } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport * as config from '../../config';\r\nimport Error from './Error';\r\n\r\nclass Join extends Component {\r\n\r\n  state = {\r\n    role: 'attendee',\r\n    username: '',\r\n    title: '',\r\n    errorMsg: '',\r\n    showError: false\r\n  }\r\n\r\n  constructor() {\r\n    super ();\r\n    this.inputRef = React.createRef();\r\n    this.baseHref = config.BASE_HREF;\r\n  }\r\n\r\n  componentDidMount() {\r\n    const qs = new URLSearchParams(this.props.location.search);\r\n    const room = qs.get('room');\r\n    this.setState({ title: room });\r\n  }\r\n\r\n  joinRoom = async () => {\r\n    const { username, title } = this.state;\r\n    const data = {\r\n      username,\r\n      title,\r\n      role: this.state.role\r\n    }\r\n    sessionStorage.setItem(`chime[${title}]`, JSON.stringify(data));\r\n    this.props.history.push(`${this.baseHref}/meeting?room=${title}`);\r\n  }\r\n\r\n  handleNameChange = e => {\r\n    this.setState({ username: e.target.value })\r\n  }\r\n\r\n  handleJoinRoom = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    this.joinRoom();\r\n  }\r\n\r\n  handleClick = (e) => {\r\n    let node = e.target;\r\n    let isModal = false;\r\n    while (node) {\r\n      if (node && node.classList && node.classList.contains('notice--error')) {\r\n        isModal = true;\r\n        break;\r\n      }\r\n      node = node.parentNode;\r\n    }\r\n    if (!isModal) {\r\n      this.closeError();\r\n    }\r\n  }\r\n\r\n  setErrorMsg = errorMsg => {\r\n    this.setState({ errorMsg, showError: true });\r\n  }\r\n\r\n  closeError = () => {\r\n    this.setState({ showError: false });\r\n  }\r\n\r\n  render() {\r\n    const { username } = this.state;\r\n    const joinRoomDisabled = !username;\r\n    return (\r\n      <div className=\"welcome form-grid\" onClick={this.handleClick}>\r\n\r\n        <div className=\"welcome__intro\">\r\n          <div className=\"intro__inner formatted-text\">\r\n            <h1>Amazon IVS with ChimeSDK</h1>\r\n            <h3>Create or join rooms, and watch Amazon IVS streams with anyone.</h3>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"welcome__content pd-4\">\r\n          <div className=\"content__inner\">\r\n            <h2 className=\"mg-b-2\">Hey there!</h2>\r\n            <form action=\"\">\r\n              <fieldset className=\"mg-b-2\">\r\n                <input type=\"text\" placeholder=\"Your name\" value={username} ref={this.inputRef} onChange={this.handleNameChange} />\r\n                <button className=\"mg-t-1 btn btn--primary\" disabled={joinRoomDisabled} onClick={this.handleJoinRoom}>Join room</button>\r\n              </fieldset>\r\n            </form>\r\n          </div>\r\n        </div>\r\n\r\n        {this.state.showError && (\r\n          <Error\r\n            closeError={this.closeError}\r\n            errorMsg={this.state.errorMsg}\r\n          />\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(Join);\r\n","export default __webpack_public_path__ + \"static/media/Raise-Hand.fddd95b6.svg\";","export default __webpack_public_path__ + \"static/media/close.24bebf55.svg\";","export default __webpack_public_path__ + \"static/media/un-line.c90e1b7d.svg\";","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {\r\n  DefaultPromisedWebSocketFactory,\r\n  DefaultDOMWebSocketFactory,\r\n  FullJitterBackoff,\r\n  ReconnectingPromisedWebSocket\r\n} from 'amazon-chime-sdk-js';\r\nimport * as config from '../../config';\r\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\r\nimport 'react-tabs/style/react-tabs.css';\r\nimport ReactTooltip from \"react-tooltip\";\r\n\r\n// Styles\r\nimport './Chat.css';\r\n\r\nimport RaiseHandIcon from \"./../../assets/RaiseBtn/Raise-Hand.svg\";\r\nimport closeIcon from \"./../../assets/svgs/close.svg\";\r\nimport unIcon from '../../assets/svgs/un-line.svg';\r\n\r\nclass Chat extends Component {\r\n  constructor() {\r\n    super ();\r\n\r\n    this.WEB_SOCKET_TIMEOUT_MS = 130000;\r\n\r\n    this.state = {\r\n      message: '',\r\n      messages: [],\r\n      connection: null,\r\n      showPopup: false,\r\n      participants: [],\r\n      tabIndex: 0,\r\n    }\r\n    this.chatRef = React.createRef();\r\n    this.messagesEndRef = React.createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.initChatConnection();\r\n\r\n    this.props.chime.subscribeToRosterUpdate(this.rosterCallback);\r\n  }\r\n\r\n  rosterCallback = (newRoster) => {\r\n    // console.log(newRoster)\r\n    let keys = Object.keys(newRoster);\r\n    this.setState({participants: []});\r\n    let parts = [];\r\n    keys.map(key => {\r\n\r\n      if(key !== this.props.joinInfo.Attendee.AttendeeId) {\r\n        let item = {\r\n          name: newRoster[key].name,\r\n          mute: newRoster[key].muted,\r\n          host: false,\r\n        }\r\n  \r\n        parts.push(item);\r\n        this.setState({participants: parts});\r\n      }\r\n    })\r\n  }\r\n\r\n  async initChatConnection() {\r\n    const { Meeting, Attendee } = this.props.joinInfo;\r\n    const messagingUrl = `${config.CHAT_WEBSOCKET}?MeetingId=${Meeting.MeetingId}&AttendeeId=${Attendee.AttendeeId}&JoinToken=${Attendee.JoinToken}`\r\n    const connection = new ReconnectingPromisedWebSocket(\r\n      messagingUrl,\r\n      [],\r\n      'arraybuffer',\r\n      new DefaultPromisedWebSocketFactory(new DefaultDOMWebSocketFactory()),\r\n      new FullJitterBackoff(1000, 0, 10000)\r\n    );\r\n\r\n    if (config.DEBUG) console.log(connection);\r\n\r\n    await connection.open(this.WEB_SOCKET_TIMEOUT_MS);\r\n\r\n    connection.addEventListener('message', event => {\r\n      console.log(event);\r\n      const messages = this.state.messages;\r\n      // const data = event.data.split('::');\r\n      // const username = data[0];\r\n      // const message = data.slice(1).join('::'); // in case the message contains the separator '::'\r\n      const messageData = JSON.parse(event.data);\r\n      \r\n      if(messageData.Type === 'sendmessage') {\r\n        messages.push({\r\n          id: messageData.MessageId,\r\n          timestamp: messageData.Time,\r\n          username: messageData.Sender,\r\n          message: messageData.Content,\r\n          vote: messageData.Vote,\r\n        });\r\n\r\n        this.setState({ messages });\r\n      } else if(messageData.Type === 'upvote') {\r\n        messages.map(message => {\r\n          if(message.id === messageData.MessageId) {\r\n            message.vote = messageData.Vote\r\n            console.log(message)\r\n          }\r\n        });\r\n\r\n        this.setState({messages});\r\n      }\r\n      \r\n    });\r\n\r\n    this.setState({ connection });\r\n\r\n    // this.chatRef.current.focus();\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  scrollToBottom = () => {\r\n    // this.messagesEndRef.current.scrollIntoView({ behavior: 'smooth' })\r\n  }\r\n\r\n  handleChange = e => {\r\n    var str = e.target.value.replace('\\n', '');\r\n    e.target.value = str;\r\n    this.setState({ message: e.target.value })\r\n  }\r\n\r\n  handleKeyDown = (e) => {\r\n    if (e.keyCode === 13) { // keyCode 13 is carriage return\r\n      const { message, connection } = this.state;\r\n      const { username } = this.props;\r\n      if (message) {\r\n        const data = `{\r\n          \"message\": \"sendmessage\",\r\n          \"data\": \"${username}::${message.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"')}\",\r\n          \"sender\": \"${username}\",\r\n          \"content\": \"${message.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"')}\",\r\n          \"type\": \"sendmessage\"\r\n        }`;\r\n        connection.send(data);\r\n\r\n        this.setState({ message: '' });\r\n      }\r\n    }\r\n  }\r\n\r\n  handleSendMobile = () => {\r\n    const { message, connection } = this.state;\r\n    const { username } = this.props;\r\n    if (message) {\r\n      const data = `{\r\n        \"message\": \"sendmessage\",\r\n        \"data\": \"${username}::${message.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"')}\",\r\n        \"sender\": \"${username}\",\r\n        \"content\": \"${message.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"')}\",\r\n        \"type\": \"sendmessage\"\r\n      }`;\r\n      connection.send(data);\r\n\r\n      this.setState({ message: '' });\r\n    }\r\n  }\r\n\r\n  handleRoomClick = (e) => {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    const { title } = this.props;\r\n    const link = `${window.location.origin}${window.location.pathname.replace('meeting', 'index.html')}?action=join&room=${title}`;\r\n    if (config.DEBUG) console.log(link);\r\n    this.copyTextToClipboard(encodeURI(link));\r\n  }\r\n\r\n  setShowPopup = () => {\r\n    // show popup message\r\n    this.setState({ showPopup: true });\r\n\r\n    // hide popup message after 2 seconds\r\n    setTimeout(() => {\r\n      this.setState({ showPopup: false })\r\n    }, 2000);\r\n  }\r\n\r\n  copyTextToClipboard = text => {\r\n    if (navigator.clipboard) {\r\n      navigator.clipboard.writeText(text)\r\n      .then(() => {\r\n        this.setShowPopup();\r\n        if (config.DEBUG) console.log('Room link copied to clipboard');\r\n      }, (err) => {\r\n        if (config.DEBUG) console.log('Could not copy text: ', err);\r\n      });\r\n    }\r\n  }\r\n\r\n  parseUrls = (userInput) => {\r\n    // console.log(userInput);\r\n    var urlRegExp = /(http(s)?:\\/\\/.)?(www\\.)?[-a-zA-Z0-9@:%._~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_.~#?&//=]*)/g;\r\n    let formattedMessage = userInput.replace(urlRegExp, (match) => {\r\n      let formattedMatch = match;\r\n      if (!match.startsWith('http')) {\r\n        formattedMatch = `http://${match}`;\r\n      }\r\n      return `<a href=${formattedMatch} class=\"chat-line__link\" target=\"_blank\" rel=\"noopener noreferrer\">${match}</a>`;\r\n    });\r\n    return formattedMessage;\r\n  }\r\n\r\n  renderMessages = () => {\r\n    const { messages } = this.state;\r\n    return (\r\n      messages.map(message => {\r\n        let formattedMessage = this.parseUrls(message.message);\r\n        return (\r\n          <div className=\"chat-line\" key={message.timestamp}>\r\n            <p><span dangerouslySetInnerHTML={{__html: formattedMessage}} /></p>\r\n            <div className=\"chat-action\">\r\n              <span className=\"qa-tool-btn vote-icon\" data-tip data-for='tooltip-for-boost' onClick={() => this.handleUpVote(message)}></span>\r\n              <ReactTooltip id='tooltip-for-boost' type='dark' place=\"bottom\" effect=\"solid\">\r\n                <span>Boost question</span>\r\n              </ReactTooltip>\r\n              <span className=\"vote-count\"> {message.vote.length} </span>\r\n              <span className=\"border-bottom\"> </span>\r\n              <span className=\"qa-tool-btn delete-icon\" data-tip data-for='tooltip-for-remove-q'></span>\r\n              <ReactTooltip id='tooltip-for-remove-q' type='dark' place=\"bottom\" effect=\"solid\">\r\n                <span>Remove question</span>\r\n              </ReactTooltip>\r\n            </div>\r\n          </div>\r\n        )\r\n      })\r\n    )\r\n  }\r\n\r\n  handleUpVote = (message) => {\r\n    console.log(message)\r\n    if (message) {\r\n      const { connection } = this.state;\r\n      const { username } = this.props;\r\n      const data = `{\r\n        \"message\": \"sendmessage\",\r\n        \"sender\": \"${username}\",\r\n        \"id\": \"${message.id}\",\r\n        \"type\": \"upvote\"\r\n      }`;\r\n      console.log(data)\r\n      connection.send(data);\r\n\r\n      this.setState({ message: '' });\r\n    }\r\n  }\r\n\r\n  handleTabChange = (index) => {\r\n    // this.setState({\r\n    //   tabIndex: index\r\n    // })\r\n    this.props.changeTab(index);\r\n  }\r\n\r\n  renderParticipants = () => {\r\n    const { participants } = this.state;\r\n    \r\n    return (\r\n      participants.map((participant, index) => {\r\n        return (\r\n          <div className=\"participant-item\" key={index}>\r\n            <img src={RaiseHandIcon} alt=\"\" className=\"raise-hand-icon\"/>\r\n            <span className=\"participant-name\">{participant.name}</span>\r\n\r\n            <div className=\"participant-tool-btns\">\r\n              <span className=\"participant-tool-btn mute-icon\" data-tip data-for='tooltip-for-mute'>\r\n                {participant.mute && <img src={unIcon} alt=\"block\"/>}\r\n              </span>\r\n              <ReactTooltip id='tooltip-for-mute' type='dark' place=\"bottom\" effect=\"solid\">\r\n                <span>Mute participant</span>\r\n              </ReactTooltip>\r\n              <span className=\"participant-tool-btn host-icon\" data-tip data-for='tooltip-for-host'></span>\r\n              <ReactTooltip id='tooltip-for-host' type='dark' place=\"bottom\" effect=\"solid\">\r\n                <span>Make host</span>\r\n              </ReactTooltip>\r\n              <span className=\"participant-tool-btn delete-icon\" data-tip data-for='tooltip-for-remove'></span>\r\n              <ReactTooltip id='tooltip-for-remove' type='dark' place=\"bottom\" effect=\"solid\">\r\n                <span>Remove participant</span>\r\n              </ReactTooltip>\r\n            </div>\r\n          </div>\r\n        );\r\n      })\r\n    );\r\n  }\r\n\r\n\r\n  render() {\r\n    const { message } = this.state;\r\n    // const popup = showPopup ? 'show' : '';\r\n    const isChrome = navigator.userAgent.indexOf(\"Chrome\") !== 1;\r\n    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n    const iosChromeClassForInput = (isChrome && isIOS) ? 'ioschrome-input' : '';\r\n    const iosChromeClassForMessages = (isChrome && isIOS) ? 'ioschrome-messages' : '';\r\n   \r\n    return (\r\n      <div className=\"chat full-height pos-relative\">\r\n        <div className=\"close-button\" onClick={this.props.closeChat}>\r\n          <img src={closeIcon} alt=\"Close Icon\" />\r\n          <span>CLOSE</span>\r\n        </div>\r\n        <div className=\"chat__wrapper full-width pos-relative\">\r\n          <Tabs onSelect={index => {this.handleTabChange(index)}} selectedIndex={this.props.isChat ? 0 : 1}>\r\n            <div className=\"desktop-tab\">\r\n              <TabList>\r\n                <Tab>Q&A</Tab>\r\n                <Tab>PARTICIPANTS</Tab>\r\n              </TabList>\r\n            </div>\r\n\r\n            <div className=\"mobile-tab-title\">\r\n            {this.props.isChat ? \"Q&A\" : \"Participants\"}\r\n            </div>\r\n      \r\n            <TabPanel>\r\n              <div className=\"message-container\">\r\n                <div className={`messages pd-x-1 ${iosChromeClassForMessages}`}>\r\n                  {this.renderMessages()}\r\n                  <div ref={this.messagesEndRef} />\r\n                </div>\r\n\r\n                <div className={`composer chime-web-composer full-width ${iosChromeClassForInput}`}>\r\n                  <span className=\"label\">\r\n                    Submit question\r\n                  </span>\r\n                  <textarea\r\n                    ref={this.chatRef}\r\n                    placeholder=\"Type question here...\"\r\n                    value={message}\r\n                    maxLength={510}\r\n                    rows={3}\r\n                    onChange={this.handleChange}\r\n                    onKeyDown={this.handleKeyDown}\r\n                    className=\"chat-input desktop-question-input\"\r\n                  />\r\n                  <textarea\r\n                    ref={this.chatRef}\r\n                    placeholder=\"Type question here...\"\r\n                    value={message}\r\n                    maxLength={510}\r\n                    rows={3}\r\n                    onChange={this.handleChange}\r\n                    className=\"chat-input mobile-question-input\"\r\n                  />\r\n                </div>\r\n\r\n                <div className={`mobile-submit-btn-container ${iosChromeClassForInput}`}>\r\n                  <button onClick={this.handleSendMobile}>submit question</button>\r\n                </div>\r\n              </div>\r\n            </TabPanel>\r\n            <TabPanel>\r\n              <div className=\"messages pd-x-1\">\r\n                {this.renderParticipants()}\r\n              </div>\r\n            </TabPanel>\r\n          </Tabs>\r\n          \r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nChat.propTypes = {\r\n  chime: PropTypes.object,\r\n  title: PropTypes.string,\r\n  username: PropTypes.string,\r\n  joinInfo: PropTypes.object,\r\n  closeChat:  PropTypes.func,\r\n  isChat: PropTypes.bool,\r\n  changeTab: PropTypes.func\r\n};\r\n\r\nexport default Chat;\r\n","export default __webpack_public_path__ + \"static/media/mute.aec53e75.svg\";","export default __webpack_public_path__ + \"static/media/camera.776f1869.svg\";","export default __webpack_public_path__ + \"static/media/share.3313e06a.svg\";","export default __webpack_public_path__ + \"static/media/hand.c928c6c0.svg\";","export default __webpack_public_path__ + \"static/media/qa.ce90c700.svg\";","export default __webpack_public_path__ + \"static/media/qaa.35a6a8e2.svg\";","export default __webpack_public_path__ + \"static/media/user.7a529212.svg\";","export default __webpack_public_path__ + \"static/media/usera.ac1cee42.svg\";","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport unIcon from '../../assets/svgs/un-line.svg';\r\nimport muteIcon from '../../assets/svgs/mute.svg';\r\nimport cameraIcon from '../../assets/svgs/camera.svg';\r\nimport shareIcon from '../../assets/svgs/share.svg';\r\nimport handIcon from '../../assets/svgs/hand.svg';\r\nimport qaIcon from '../../assets/svgs/qa.svg';\r\nimport qaaIcon from '../../assets/svgs/qaa.svg';\r\nimport userIcon from '../../assets/svgs/user.svg';\r\nimport useraIcon from '../../assets/svgs/usera.svg';\r\n\r\nimport './control.css';\r\n\r\nclass Controls extends Component {\r\n\r\n  state = {\r\n    muted: false,\r\n    focus: false,\r\n    videoStatus: 'Disabled',\r\n    handRaiseStatus: true,\r\n    shareScreenStatue: true,\r\n    openChatStatus: false,\r\n    openParticipantsStatus: false,\r\n  };\r\n\r\n  callback = (localMuted) => {\r\n    this.setState({ muted: localMuted });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.props.chime.audioVideo.realtimeSubscribeToMuteAndUnmuteLocalAudio(\r\n      this.callback\r\n    );\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.props && this.props.chime.audioVideo) {\r\n      this.props.chime.audioVideo.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(\r\n        this.callback\r\n      );\r\n    }\r\n  }\r\n\r\n  muteButtonOnClick = async () => {\r\n    if (this.state.muted) {\r\n      this.props.chime.audioVideo.realtimeUnmuteLocalAudio();\r\n    } else {\r\n      this.props.chime.audioVideo.realtimeMuteLocalAudio();\r\n    }\r\n    await new Promise(resolve => setTimeout(resolve, 10));\r\n  }\r\n\r\n  raiseButtonOnClick = async () => {\r\n    if (this.state.handRaiseStatus === false) {\r\n      this.setState({ handRaiseStatus: true });\r\n    }\r\n    else {\r\n      this.setState({ handRaiseStatus: false });\r\n    }\r\n  }\r\n\r\n  shareButtonOnClick = async () => {\r\n    if (this.state.shareScreenStatue === false) {\r\n      this.setState({ shareScreenStatue: true });\r\n      await this.props.chime.audioVideo.stopContentShare();\r\n    }\r\n    else {\r\n      this.setState({ shareScreenStatue: false });\r\n      await this.props.chime.audioVideo.startContentShareFromScreenCapture();\r\n    }\r\n  }\r\n\r\n  videoButtonOnClick = async () => {\r\n    await new Promise(resolve => setTimeout(resolve, 10));\r\n    if (this.state.videoStatus === 'Disabled') {\r\n      this.setState({ videoStatus: 'Loading' });\r\n      try {\r\n        if (!this.props.chime.currentVideoInputDevice) {\r\n          throw new Error('currentVideoInputDevice does not exist');\r\n        }\r\n\r\n        try {\r\n          const videoInputDevices = await this.props.chime.audioVideo.listVideoInputDevices();\r\n          // await this.props.chime.chooseVideoInputDevice(\r\n          //   this.props.chime.currentVideoInputDevice\r\n          // );\r\n\r\n          let selectedDevice = this.props.chime.currentVideoInputDevice;\r\n          if(videoInputDevices.length >= 2) {\r\n            videoInputDevices.map(device => {\r\n              if(device.label.toLowerCase().includes('front')) {\r\n                selectedDevice = {\r\n                  label: device.label,\r\n                  value: device.deviceId\r\n                };\r\n\r\n                console.log(device);\r\n              }\r\n            })\r\n          }\r\n\r\n          await this.props.chime.chooseVideoInputDevice(selectedDevice);\r\n\r\n        } catch (err) {\r\n          const videoInputDevices = await this.props.chime.audioVideo.listVideoInputDevices();\r\n          console.log(videoInputDevices)\r\n          await this.props.chime.audioVideo.chooseVideoInputDevice(videoInputDevices[0].deviceId);\r\n        }\r\n\r\n        this.props.chime.audioVideo.startLocalVideoTile();\r\n\r\n        this.setState({ videoStatus: 'Enabled' });\r\n      } catch (error) {\r\n        // eslint-disable-next-line\r\n        console.error(error);\r\n        this.setState({ videoStatus: 'Disabled' });\r\n      }\r\n    } else if (this.state.videoStatus === 'Enabled') {\r\n      this.setState({ videoStatus: 'Loading' });\r\n      this.props.chime.meetingSession.audioVideo.stopLocalVideoTile();\r\n      this.setState({ videoStatus: 'Disabled' });\r\n    }\r\n  }\r\n\r\n  endButtonOnClick = async () => {\r\n    await this.props.chime.leaveRoom(this.props.role === 'host');\r\n    sessionStorage.removeItem(this.props.ssName);\r\n    const whereTo = `${this.props.baseHref}/${this.props.role === 'host' ? '' : 'join?room=' + this.props.title}`;\r\n    this.props.history.push(whereTo);\r\n  }\r\n\r\n  toggleChat = () => {\r\n    if (this.state.openChatStatus === false) {\r\n      this.setState({ openChatStatus: true, openParticipantsStatus: false });\r\n      this.props.openChat();\r\n    }\r\n    else {\r\n      this.setState({ openChatStatus: false });\r\n      this.props.closeChat();\r\n    }\r\n  }\r\n\r\n  togglePT = () => {\r\n    if (this.state.openParticipantsStatus === false) {\r\n      this.setState({ openParticipantsStatus: true, openChatStatus: false });\r\n      this.props.openPT();\r\n    }\r\n    else {\r\n      this.setState({ openParticipantsStatus: false });\r\n      this.props.closeChat();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const mic_controls = this.state.muted ? 'controls__btn--mic_on' : 'controls__btn--mic_off';\r\n    const cam_controls = this.state.videoStatus === 'Enabled' ? 'controls__btn--cam_off' : 'controls__btn--cam_on';\r\n    const hand_controls = this.state.handRaiseStatus ? 'controls__btn--raise-on' : 'controls__btn--raise-off';\r\n    const share_controls = this.state.shareScreenStatue ? 'controls__btn--share-on' : 'controls__btn--share-off';\r\n    return (\r\n      <div className=\"controls pos-relative\">\r\n        <div className=\"button-group1\">\r\n          <button className={`controls__btn ${mic_controls} btn rounded btn--mic`} onClick={this.muteButtonOnClick}>\r\n            <div className=\"btn__svg btn__svg--mic_on button-layout btn-toggle\" >\r\n              <img src={muteIcon} alt=\"mute icon\" className={`toggle-icon ${this.state.muted ? 'toggle-off-icon' : ''}`}></img>\r\n              {\r\n                this.state.muted && <img src={unIcon} alt=\"block icon\" className={'un-icon mute-block'}></img>\r\n              }\r\n              <span className=\"txt-oncontrolbtn toggle-text\">{this.state.muted ? 'Unmute' : 'Mute'}</span>\r\n            </div>\r\n          </button>\r\n\r\n          <button className={`controls__btn ${cam_controls} btn rounded btn--cam`} onClick={this.videoButtonOnClick}>\r\n            <div className=\"btn__svg btn__svg--cam_on button-layout btn-toggle\">\r\n              <img src={cameraIcon} alt=\"camera icon\" className={`toggle-icon ${this.state.videoStatus !== 'Enabled' ? 'toggle-off-icon' : ''}`}></img>\r\n              {\r\n                this.state.videoStatus !== 'Enabled' && <img src={unIcon} alt=\"block icon\" className={'un-icon camera-block'}></img>\r\n              }\r\n              <span className=\"txt-oncontrolbtn toggle-text\">{this.state.videoStatus === 'Enabled' ? 'Camera on' : 'Camera off'}</span>\r\n            </div>\r\n          </button>\r\n        \r\n          <button className={`controls__btn ${share_controls} btn rounded btn--share`} onClick={this.shareButtonOnClick}>\r\n            <div className=\"btn__svg btn__svg--share_on button-layout btn-toggle\">\r\n              <img src={shareIcon} alt=\"share icon\" className={`toggle-icon ${this.state.shareScreenStatue ? 'toggle-off-icon' : ''}`}></img>\r\n              {\r\n                this.state.shareScreenStatue && <img src={unIcon} alt=\"block icon\" className={'un-icon share-block'}></img>\r\n              }\r\n              <span className=\"txt-oncontrolbtn toggle-text\">{this.state.shareScreenStatue ? 'Share screen' : 'Stop sharing'}</span>\r\n            </div>\r\n          </button>\r\n          <button className={`controls__btn ${hand_controls} btn rounded btn--hand`} onClick={this.raiseButtonOnClick}>\r\n            <div className=\"btn__svg btn__svg--hand_on button-layout btn-toggle\">\r\n              <img src={handIcon} alt=\"raise icon\" className={`toggle-icon raise-toggle-icon ${this.state.handRaiseStatus ? 'toggle-off-icon' : ''}`}></img>\r\n              {\r\n                this.state.handRaiseStatus && <img src={unIcon} alt=\"block icon\" className={'un-icon hand-block'}></img>\r\n              }\r\n              <span className=\"txt-oncontrolbtn toggle-text\">{this.state.handRaiseStatus ? 'Raise hand' : 'Lower hand'}</span>\r\n            </div>\r\n          </button>\r\n\r\n          <button className={`controls__btn ${share_controls} btn rounded btn--qa`} onClick={this.toggleChat}>\r\n            <div className=\"btn__svg btn__svg--share_on button-layout btn-toggle\">\r\n              <img src={this.props.isOpenChat && this.state.openChatStatus ? qaaIcon : qaIcon} alt=\"qa icon\" className={'toggle-icon'}></img>\r\n              <span className=\"txt-oncontrolbtn toggle-text\">Q&A</span>\r\n            </div>\r\n          </button>\r\n\r\n          <button className={`controls__btn ${share_controls} btn rounded btn--participants`} onClick={this.togglePT}>\r\n            <div className=\"btn__svg btn__svg--share_on button-layout btn-toggle\">\r\n              <img src={this.props.isOpenChat && this.state.openParticipantsStatus ? useraIcon : userIcon} alt=\"qa icon\" className={'toggle-icon'}></img>\r\n              <span className=\"txt-oncontrolbtn toggle-text\">Participants</span>\r\n            </div>\r\n          </button>\r\n        </div>\r\n        <div className=\"button-group3\">\r\n          <button className=\"go-livebtn\" onClick={this.props.openSettings}>\r\n            <span className=\"txt-onbtn\">GO LIVE</span>\r\n          </button>\r\n          <button className=\"live-meetingbtn txt-onbtn\" onClick={this.endButtonOnClick}>\r\n            <span className=\"txt-onbtn\">LEAVE MEETING</span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nControls.propTypes = {\r\n  chime: PropTypes.object,\r\n  baseHref: PropTypes.string,\r\n  ssName: PropTypes.string,\r\n  title: PropTypes.string,\r\n  openSettings: PropTypes.func,\r\n  role: PropTypes.string,\r\n  history: PropTypes.object,\r\n  myVideoElement: PropTypes.object,\r\n  openChat: PropTypes.func,\r\n  openPT: PropTypes.func,\r\n  closeChat: PropTypes.func,\r\n  isOpenChat: PropTypes.bool\r\n};\r\n\r\nexport default Controls;\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport * as config from '../../config';\r\n\r\nclass Settings extends Component {\r\n\r\n  state = {\r\n    microphone: '',\r\n    speaker: '',\r\n    camera: ''\r\n  }\r\n\r\n  devicesUpdatedCallback = (fullDeviceInfo) => {\r\n    if (config.DEBUG) console.log(fullDeviceInfo);\r\n  };\r\n\r\n  componentDidMount() {\r\n    document.addEventListener(\"keydown\", this.handleKeyDown);\r\n\r\n    this.props.chime.subscribeToDevicesUpdated(this.devicesUpdatedCallback);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"keydown\", this.handleKeyDown);\r\n\r\n    this.props.chime.unsubscribeFromDevicesUpdated(this.devicesUpdatedCallback);\r\n  }\r\n\r\n  handleKeyDown = (e) => {\r\n    if (e.keyCode === 27) { // keyCode 27 is Escape key\r\n      this.props.closeSettings();\r\n    }\r\n  }\r\n\r\n  handlePlaybackURLChange = (e) => {\r\n    this.setState({ playbackURL: e.target.value });\r\n  }\r\n\r\n  handleMicrophoneChange = (e) => {\r\n    this.setState({ microphone: e.target.value });\r\n\r\n    if (this.props.chime.audioInputDevices.length) {\r\n      let selectedDevice;\r\n      let o;\r\n      for (o in this.props.chime.audioInputDevices) {\r\n        if (this.props.chime.audioInputDevices[o].value === e.target.value) {\r\n          selectedDevice = this.props.chime.audioInputDevices[o];\r\n          break;\r\n        }\r\n      }\r\n      this.props.chime.chooseAudioInputDevice(selectedDevice);\r\n    }\r\n  }\r\n\r\n  handleSpeakerChange = (e) => {\r\n    this.setState({ speaker: e.target.value });\r\n\r\n    if (this.props.chime.audioOutputDevices.length) {\r\n      let selectedDevice;\r\n      let o;\r\n      for (o in this.props.chime.audioOutputDevices) {\r\n        if (this.props.chime.audioOutputDevices[o].value === e.target.value) {\r\n          selectedDevice = this.props.chime.audioOutputDevices[o];\r\n          break;\r\n        }\r\n      }\r\n      this.props.chime.chooseAudioOutputDevice(selectedDevice);\r\n    }\r\n  }\r\n\r\n  handleCameraChange = async (e) => {\r\n    this.setState({ camera: e.target.value });\r\n\r\n    if (this.props.chime.videoInputDevices.length) {\r\n      let selectedDevice;\r\n      let o;\r\n      for (o in this.props.chime.videoInputDevices) {\r\n        if (this.props.chime.videoInputDevices[o].value === e.target.value) {\r\n          selectedDevice = this.props.chime.videoInputDevices[o];\r\n          break;\r\n        }\r\n      }\r\n      this.props.chime.chooseVideoInputDevice(selectedDevice);\r\n    }\r\n  }\r\n\r\n  handleSave = (e) => {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    const {microphone, speaker, camera } = this.state;\r\n    this.props.saveSettings(microphone, speaker, camera);\r\n  }\r\n\r\n  renderDevices = (devices, defaultValue, label) => {\r\n    if (devices && devices.length) {\r\n      return (\r\n        devices.map(device => {\r\n          return (\r\n            <option key={device.value} value={device.value}>{`${device.label}`}</option>\r\n          )\r\n        })\r\n      )\r\n    } else {\r\n      return (\r\n      <option value=\"no-permission\">{`Permission not granted to access ${label} devices`}</option>\r\n      );\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const currentMic = this.props.chime.currentAudioInputDevice;\r\n    const currentSpeaker = this.props.chime.currentAudioOutputDevice;\r\n    const currentCam = this.props.chime.currentVideoInputDevice;\r\n    const availableMics = this.props.chime.audioInputDevices;\r\n    const availableSpeakers = this.props.chime.audioOutputDevices;\r\n    const availableCams = this.props.chime.videoInputDevices;\r\n\r\n    return (\r\n      <div className=\"modal pos-absolute top-0 bottom-0 \">\r\n        <div className=\"modal__el\">\r\n          <h1 className=\"mg-b-2\">Settings</h1>\r\n          <form>\r\n            <fieldset>\r\n              <input className=\"mg-b-2\" name=\"\" id=\"\" type=\"text\" readOnly={true} placeholder=\"Playback URL\" onChange={this.handlePlaybackURLChange} value={this.props.joinInfo.PlaybackURL} disabled />\r\n              <select\r\n                name=\"microphone\"\r\n                className=\"select__field\"\r\n                onChange={this.handleMicrophoneChange}\r\n                value={this.state.microphone || currentMic.value}\r\n                disabled={!availableMics.length}\r\n              >\r\n                {this.renderDevices(availableMics, currentMic, 'microphone')}\r\n              </select>\r\n              <select\r\n                name=\"speaker\"\r\n                className=\"select__field\"\r\n                onChange={this.handleSpeakerChange}\r\n                value={this.state.speaker || currentSpeaker.value}\r\n                disabled={!availableSpeakers.length}\r\n              >\r\n                {this.renderDevices(availableSpeakers, currentSpeaker, 'speaker')}\r\n              </select>\r\n              <select\r\n                name=\"camera\"\r\n                className=\"select__field\"\r\n                onChange={this.handleCameraChange}\r\n                value={this.state.camera || currentCam.value}\r\n                disabled={!availableCams.length}\r\n              >\r\n                {this.renderDevices(availableCams, currentCam, 'camera')}\r\n              </select>\r\n              <button className=\"btn btn--primary mg-t-2\" onClick={this.handleSave}>Save</button>\r\n            </fieldset>\r\n          </form>\r\n        </div>\r\n        <div className=\"modal__overlay\"></div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nSettings.propTypes = {\r\n  chime: PropTypes.object,\r\n  joinInfo: PropTypes.object,\r\n  saveSettings: PropTypes.func,\r\n  closeSettings: PropTypes.func,\r\n  settings: PropTypes.object,\r\n  checkAudioVideoPermission: PropTypes.func,\r\n  updateAudioVideoDevices: PropTypes.func,\r\n};\r\n\r\nexport default Settings;\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nclass LocalVideo extends Component {\r\n\r\n  state = {\r\n    enabled: false,\r\n    muted: false,\r\n    showMeta: true\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.videoElement = React.createRef();\r\n  }\r\n\r\n  rosterCallback = (newRoster) => {\r\n\r\n    let attendeeId;\r\n    for (attendeeId in newRoster) {\r\n\r\n      // Exclude others\r\n      if (attendeeId !== this.props.joinInfo.Attendee.AttendeeId) {\r\n        continue;\r\n      }\r\n\r\n      this.setState({ muted: newRoster[attendeeId].muted });\r\n    }\r\n  };\r\n\r\n  componentDidMount() {\r\n    // Hide meta info after 2 seconds\r\n    setTimeout(() => {\r\n      this.setState({\r\n        showMeta: false\r\n      });\r\n    }, 2500);\r\n\r\n    this.props.chime.audioVideo.addObserver({\r\n      videoTileDidUpdate: (tileState) => {\r\n        if (\r\n          !tileState.boundAttendeeId ||\r\n          !tileState.localTile ||\r\n          !tileState.tileId ||\r\n          !this.videoElement.current\r\n        ) {\r\n          return;\r\n        }\r\n        this.props.chime.audioVideo.bindVideoElement(\r\n          tileState.tileId,\r\n          this.videoElement.current\r\n        );\r\n        this.setState({\r\n          enabled: tileState.active\r\n        });\r\n      }\r\n    });\r\n\r\n    this.props.chime.subscribeToRosterUpdate(this.rosterCallback);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.chime.unsubscribeFromRosterUpdate(this.rosterCallback);\r\n  }\r\n\r\n  handleMouseEnter(e) {\r\n    this.setState({\r\n      showMeta: true\r\n    });\r\n  }\r\n\r\n  handleMouseLeave(e) {\r\n    this.setState({\r\n      showMeta: false\r\n    });\r\n  }\r\n\r\n  render() {\r\n    // always show metadata when muted\r\n    // const showMeta = this.state.showMeta || this.state.muted || !this.state.enabled;\r\n\r\n    // const micMuteCls = this.state.muted ? 'controls__btn--mic_on' : 'controls__btn--mic_off';\r\n    // const metaCls = showMeta ? '' : ' cam__meta--hide';\r\n    return (\r\n      <div className=\"cam local-cam\" onMouseEnter={this.handleMouseEnter.bind(this)} onMouseLeave={this.handleMouseLeave.bind(this)}>\r\n        <div className=\"cam__preview\">\r\n          <div className=\"video-container pos-relative\">\r\n            <video className=\"attendee_cam\" ref={this.videoElement} />\r\n          </div>\r\n        </div>\r\n        {/* <span className={`cam__meta${metaCls}`} id={`${this.props.joinInfo.Attendee.AttendeeId}`}>\r\n          You\r\n          <span className={`${micMuteCls} btn--mic`} data-id={this.props.joinInfo.Attendee.AttendeeId}>\r\n            <svg className=\"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_on\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M12 14C13.66 14 14.99 12.66 14.99 11L15 5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14ZM17.3 11C17.3 14 14.76 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C16.28 17.24 19 14.42 19 11H17.3Z\" fill=\"white\"/></svg>\r\n            <svg className=\"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_off\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z\" fill=\"white\"/></svg>\r\n          </span>\r\n        </span> */}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nLocalVideo.propTypes = {\r\n  chime: PropTypes.object,\r\n  joinInfo: PropTypes.object\r\n};\r\n\r\nexport default LocalVideo;\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nclass RemoteVideo extends Component {\r\n\r\n  state = {\r\n    showMeta: true\r\n  }\r\n  \r\n  componentDidMount() {\r\n    // Hide meta info after 2 seconds\r\n    if (!this.props.muted) {\r\n      setTimeout(() => {\r\n        this.setState({\r\n          showMeta: false\r\n        });\r\n      }, 2000);\r\n    }\r\n  }\r\n\r\n  handleMouseEnter(e) {\r\n    this.setState({\r\n      showMeta: true\r\n    });\r\n  }\r\n\r\n  handleMouseLeave(e) {\r\n    this.setState({\r\n      showMeta: false\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      attendeeId,\r\n      // videoEnabled,\r\n      // name,\r\n      // muted,\r\n      videoElement\r\n    } = this.props;\r\n    // always show metadata when participant is muted or cam is off\r\n    // const showMeta = this.state.showMeta || muted || !videoEnabled;\r\n\r\n    const camClass = attendeeId ? '' : ' hidden';\r\n    // const micMuteCls = muted ? 'controls__btn--mic_on' : 'controls__btn--mic_off';\r\n    // const metaCls =  showMeta ? '' : ' cam__meta--hide';\r\n    const videoId = `video_${attendeeId}`;\r\n    return(\r\n\r\n        <div className={`cam${camClass} cam-layout-${this.props.count}`} key={attendeeId} onMouseEnter={this.handleMouseEnter.bind(this)} onMouseLeave={this.handleMouseLeave.bind(this)}>\r\n          <div className=\"cam__preview\">\r\n            <div className=\"video-container pos-relative\">\r\n              <video ref={videoElement} className=\"attendee_cam remote-attendee\" id={videoId} />\r\n            </div>\r\n\r\n            <div className=\"remote-bottom-bar\">\r\n              Josh Krohn - The University of Law\r\n            </div>\r\n          </div>\r\n          {/* <span className={`cam__meta${metaCls}`}>\r\n            {name}\r\n            <span className={`${micMuteCls} btn--mic`} data-id={attendeeId}>\r\n              <svg className=\"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_on\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M12 14C13.66 14 14.99 12.66 14.99 11L15 5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14ZM17.3 11C17.3 14 14.76 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C16.28 17.24 19 14.42 19 11H17.3Z\" fill=\"white\"/></svg>\r\n              <svg className=\"attendee mg-l-1 btn__svg btn__svg--sm btn__svg--mic_off\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M19 11H17.3C17.3 11.74 17.14 12.43 16.87 13.05L18.1 14.28C18.66 13.3 19 12.19 19 11ZM14.98 11.17C14.98 11.11 15 11.06 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V5.18L14.98 11.17ZM4.27 3L3 4.27L9.01 10.28V11C9.01 12.66 10.34 14 12 14C12.22 14 12.44 13.97 12.65 13.92L14.31 15.58C13.6 15.91 12.81 16.1 12 16.1C9.24 16.1 6.7 14 6.7 11H5C5 14.41 7.72 17.23 11 17.72V21H13V17.72C13.91 17.59 14.77 17.27 15.54 16.82L19.73 21L21 19.73L4.27 3Z\" fill=\"white\"/></svg>\r\n            </span>\r\n          </span> */}\r\n        </div>\r\n\r\n    )\r\n  }\r\n}\r\n\r\nRemoteVideo.propTypes = {\r\n  chime: PropTypes.object,\r\n  attendeeId: PropTypes.string,\r\n  videoEnabled: PropTypes.bool,\r\n  name: PropTypes.string,\r\n  muted: PropTypes.bool,\r\n  videoElement: PropTypes.object,\r\n  count: PropTypes.number\r\n};\r\n\r\nexport default RemoteVideo;\r\n","import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport RemoteVideo from './RemoteVideo';\r\nimport * as config from '../../config';\r\n\r\nconst MAX_REMOTE_VIDEOS = config.CHIME_ROOM_MAX_ATTENDEE;\r\n\r\nclass RemoteVideoGroup extends Component {\r\n\r\n  state = {\r\n    rosterChanged: false,\r\n    roster: [],\r\n    shareVideoElement: React.createRef(),\r\n    isMyContent: false,\r\n    isSharingContent: false,\r\n    sharingTileId: 0,\r\n    sharingInfo: {}\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    this.previousRoster = {};\r\n  }\r\n\r\n  findRosterSlot = (attendeeId) => {\r\n    let index;\r\n    for (index = 0; index < this.state.roster.length; index++) {\r\n      if (this.state.roster[index].attendeeId === attendeeId) {\r\n        return index;\r\n      }\r\n    }\r\n    for (index = 0; index < this.state.roster.length; index++) {\r\n      if (!this.state.roster[index].attendeeId) {\r\n        return index;\r\n      }\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  rosterCallback = (newRoster) => {\r\n    if (Object.keys(newRoster).length > 2) {\r\n      if (config.DEBUG) console.log('More than 2');\r\n    }\r\n\r\n    if (Object.keys(newRoster).length < Object.keys(this.previousRoster).length) {\r\n      if (config.DEBUG) console.log('Attendee(s) left');\r\n      const differ = Object.keys(this.previousRoster).filter(k => this.previousRoster[k] !== newRoster[k]);\r\n      if (config.DEBUG) console.log(differ);\r\n\r\n      if (differ.length) {\r\n        let i;\r\n        for (i in differ) {\r\n          const index = this.findRosterSlot(differ[i]);\r\n          const roster = this.state.roster;\r\n          roster[index] = {\r\n            videoElement: roster[index].videoElement\r\n          }\r\n          this.setState({ roster });\r\n        }\r\n      }\r\n    }\r\n\r\n    this.previousRoster = Object.assign({}, newRoster);\r\n\r\n    let attendeeId;\r\n    for (attendeeId in newRoster) {\r\n\r\n      // Exclude self\r\n      if (attendeeId === this.props.joinInfo.Attendee.AttendeeId) {\r\n        continue;\r\n      }\r\n\r\n      // exclude empty name\r\n      if (!newRoster[attendeeId].name) {\r\n        continue;\r\n      }\r\n\r\n      const index = this.findRosterSlot(attendeeId);\r\n      const roster = this.state.roster;\r\n      const attendee = {\r\n        ...roster[index],\r\n        attendeeId,\r\n        ...newRoster[attendeeId]\r\n      };\r\n\r\n      roster[index] = attendee;\r\n      this.setState({ roster });\r\n    }\r\n  };\r\n\r\n  videoTileDidUpdateCallback = async (tileState) => {\r\n    \r\n    if (\r\n      tileState.boundAttendeeId &&\r\n      // tileState.localTile &&\r\n      tileState.isContent &&\r\n      tileState.tileId\r\n    ) {\r\n      if(tileState.boundAttendeeId === this.props.joinInfo.Attendee.AttendeeId + '#content') {\r\n        this.setState({isMyContent: true});\r\n      } else {\r\n        this.setState({isMyContent: false});\r\n      }\r\n\r\n      const shareVideoElement = document.getElementById(`share_video`);\r\n      this.props.chime.audioVideo.bindVideoElement(\r\n        tileState.tileId,\r\n        shareVideoElement\r\n      );\r\n\r\n      this.setState({isSharingContent: true, sharingTileId: tileState.tileId});\r\n     \r\n      console.log(this.previousRoster[tileState.boundAttendeeId.replace('#content', '')]);\r\n      this.setState({\r\n        sharingInfo: this.previousRoster[tileState.boundAttendeeId.replace('#content', '')]\r\n      });\r\n      return;\r\n    } else {\r\n      this.setState({isSharingContent: false})\r\n    }\r\n\r\n    if (\r\n      !tileState.boundAttendeeId ||\r\n      tileState.localTile ||\r\n      tileState.isContent ||\r\n      !tileState.tileId\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    let index = this.findRosterSlot(tileState.boundAttendeeId);\r\n    const roster = this.state.roster;\r\n    const attendee = {\r\n      ...roster[index],\r\n      videoEnabled: tileState.active,\r\n      attendeeId: tileState.boundAttendeeId,\r\n      tileId: tileState.tileId\r\n    };\r\n    roster[index] = attendee;\r\n    this.setState({ roster });\r\n\r\n    setTimeout(() => {\r\n      if (config.DEBUG) console.log(roster[index]);\r\n      const videoElement = document.getElementById(`video_${tileState.boundAttendeeId}`);\r\n      if (videoElement) {\r\n        this.props.chime.audioVideo.bindVideoElement(\r\n          tileState.tileId,\r\n          videoElement\r\n        );\r\n      }\r\n    }, 1000);\r\n  };\r\n\r\n  videoTileWasRemovedCallback = (tileId) => {\r\n    let roster = this.state.roster;\r\n\r\n    // Find the removed tileId in the roster and mark the video as disabled.\r\n    // eslint-disable-next-line\r\n    if(tileId === this.state.sharingTileId) {\r\n      this.setState({\r\n        sharingTileId: 0, \r\n        isMyContent: false,\r\n        isSharingContent: false,\r\n        sharingInfo: {}\r\n      });\r\n    }\r\n\r\n    roster.find((o, i) => {\r\n      if (o.tileId === tileId) {\r\n        roster[i].videoEnabled = false;\r\n        this.setState({ roster });\r\n        if (config.DEBUG) console.log(`Tile was removed ${tileId}`);\r\n      }\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    const roster = [];\r\n    // eslint-disable-next-line\r\n    Array.from(Array(MAX_REMOTE_VIDEOS).keys()).map((key, index) => {\r\n      roster[index] = {\r\n        videoElement: React.createRef()\r\n      };\r\n    });\r\n    this.setState({ roster });\r\n\r\n    this.props.chime.subscribeToRosterUpdate(this.rosterCallback);\r\n\r\n    this.props.chime.audioVideo.addObserver({\r\n      videoTileDidUpdate: this.videoTileDidUpdateCallback,\r\n      videoTileWasRemoved: this.videoTileWasRemovedCallback,\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.chime.unsubscribeFromRosterUpdate(this.rosterCallback);\r\n  }\r\n\r\n  stopHandle = async () => {\r\n    await this.props.chime.audioVideo.stopContentShare();\r\n  }\r\n\r\n  render() {\r\n    let count = 0;\r\n    this.state.roster.map((attendee) => {\r\n      if(attendee.attendeeId) count++;\r\n    })\r\n\r\n    let {shareVideoElement, isMyContent, isSharingContent, sharingInfo} = this.state;\r\n    \r\n    return(\r\n      <React.Fragment>\r\n        <div className={`sharing-video-container ${isMyContent || !isSharingContent ? 'display-none': ''}`}>\r\n          <video ref={shareVideoElement} className=\"\" id='share_video' />\r\n        </div>\r\n\r\n        {isSharingContent && (\r\n          <div className={'sharing-headline-container'}>\r\n            {isMyContent ? <span className=\"sharing-text\">You are currently sharing your screen</span> : \r\n            <span className=\"sharing-text\">{sharingInfo.name} is currently screen sharing</span>}\r\n            \r\n            {isMyContent && <button className=\"mycontent-stop-sharing\" onClick={this.stopHandle}>STOP SHARING</button>}\r\n          </div>\r\n        )}\r\n        \r\n        \r\n        <div className={`remote-cams-container ${!isMyContent && isSharingContent ? 'display-none' : ''}`}>\r\n          {this.state.roster.map((attendee, index) => {\r\n            return (\r\n              <RemoteVideo\r\n                chime={this.props.chime}\r\n                key={index}\r\n                attendeeId={attendee.attendeeId}\r\n                videoEnabled={attendee.videoEnabled}\r\n                name={attendee.name}\r\n                muted={attendee.muted}\r\n                videoElement={attendee.videoElement}\r\n                count={count}\r\n              />\r\n            );\r\n          })}\r\n        </div>\r\n      </React.Fragment>\r\n    )\r\n  }\r\n}\r\n\r\nRemoteVideoGroup.propTypes = {\r\n  chime: PropTypes.object,\r\n  joinInfo: PropTypes.object\r\n};\r\n\r\nexport default RemoteVideoGroup;\r\n","export default __webpack_public_path__ + \"static/media/UoL.3e01f2ee.svg\";","export default __webpack_public_path__ + \"static/media/v-icon.c9bccf9e.svg\";","import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport PropTypes from \"prop-types\";\r\nimport * as config from \"../../config\";\r\n\r\nimport { MeetingSessionStatusCode } from \"amazon-chime-sdk-js\";\r\n\r\n// Components\r\n// import VideoPlayer from \"../videoPlayer/VideoPlayer\";\r\nimport Chat from \"../chat/Chat\";\r\nimport Controls from \"./Controls\";\r\nimport Settings from \"./Settings\";\r\nimport Error from \"./Error\";\r\nimport LocalVideo from './LocalVideo';\r\nimport RemoteVideoGroup from './RemoteVideoGroup';\r\nimport Alert from './Alert';\r\n\r\n// Styles\r\nimport \"./ChimeWeb.css\";\r\nimport \"./Meeting.css\";\r\n\r\nimport logo from \"./../../assets/Logo.svg\";\r\nimport bodylogo from \"../../assets/UoL.svg\";\r\nimport vicon from \"../../assets/svgs/v-icon.svg\";\r\n\r\nclass Meeting extends Component {\r\n    state = {\r\n        meetingStatus: null, // Loading, Success or Failed\r\n        showSettings: false,\r\n\r\n        showError: false,\r\n        errorMsg: \"\",\r\n        showPopupMessage: false,\r\n        isChat: true,\r\n        isAvailable: false,\r\n    };\r\n\r\n    showModal = () => {\r\n        console.log(\"show modal\");\r\n        this.setState({ showPopupMessage: true });\r\n    };\r\n\r\n    openChat = () => {\r\n        this.setState({ showPopupMessage: true, isChat: true });\r\n    }\r\n\r\n    openPT = () => {\r\n        this.setState({ showPopupMessage: true, isChat: false });\r\n    }\r\n\r\n    changeChat = (index) => {\r\n        if(index === 0) this.setState({ isChat: true });\r\n        if(index === 1) this.setState({ isChat: false });\r\n    }\r\n\r\n    hideModal = () => {\r\n        console.log(\"hide modal\");\r\n        this.setState({ showPopupMessage: false });\r\n    };\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.baseHref = config.BASE_HREF;\r\n        this.ssName = \"\";\r\n\r\n        this.audioElementRef = React.createRef();\r\n        this.myVideoElement = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        const start = async () => {\r\n            try {\r\n                const qs = new URLSearchParams(this.props.location.search);\r\n                const room = qs.get(\"room\");\r\n                this.ssName = `chime[${room}]`;\r\n                if (!room || !sessionStorage.getItem(this.ssName)) {\r\n                    this.props.history.push(`${this.baseHref}/`);\r\n                }\r\n\r\n                const ssData = JSON.parse(sessionStorage.getItem(this.ssName));\r\n                if (config.DEBUG) console.log(ssData);\r\n\r\n                this.username = ssData.username;\r\n                this.title = ssData.title;\r\n                this.role = ssData.role;\r\n\r\n                if (!ssData.joinInfo) {\r\n                    this.joinInfo = await this.props.chime.createRoom(\r\n                        this.role,\r\n                        this.username,\r\n                        this.title,\r\n                        ssData.playbackURL\r\n                    );\r\n                    const data = {\r\n                        ...ssData,\r\n                        joinInfo: this.joinInfo,\r\n                    };\r\n                    sessionStorage.setItem(this.ssName, JSON.stringify(data));\r\n                    this.playbackURL = this.joinInfo.PlaybackURL;\r\n                } else {\r\n                    // Browser refresh\r\n                    this.joinInfo = ssData.joinInfo;\r\n                    this.playbackURL = ssData.joinInfo.PlaybackURL;\r\n                    await this.props.chime.reInitializeMeetingSession(\r\n                        this.joinInfo,\r\n                        this.username\r\n                    );\r\n                }\r\n\r\n                this.setState({ meetingStatus: \"Success\" });\r\n\r\n                this.props.chime.audioVideo.addObserver({\r\n                    audioVideoDidStop: async (sessionStatus) => {\r\n                        if (\r\n                            sessionStatus.statusCode() ===\r\n                            MeetingSessionStatusCode.AudioCallEnded\r\n                        ) {\r\n                            const whereTo = `${this.baseHref}/${\r\n                                this.role === \"host\" ? \"\" : \"end\"\r\n                            }`;\r\n                            this.props.chime.leaveRoom(this.role === \"host\");\r\n                            this.props.history.push(whereTo);\r\n                        }\r\n                    },\r\n                });\r\n\r\n                // this.props.chime.joinRoom(this.audioElementRef.current);\r\n                await this.props.chime.joinRoom(this.audioElementRef.current);\r\n            } catch (error) {\r\n                // eslint-disable-next-line\r\n                console.error(error);\r\n                this.setState({ meetingStatus: \"Failed\" });\r\n            }\r\n        };\r\n        start();\r\n\r\n        try{\r\n            if(!navigator.mediaDevices.enumerateDevices) {\r\n              this.setState({isAvailable: true});\r\n            }\r\n          } catch(e) {\r\n            console.log(e)\r\n            this.setState({isAvailable: true});\r\n          }\r\n\r\n          const isChrome = navigator.userAgent.indexOf(\"Chrome\") !== 1;\r\n          const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n          \r\n          if(isChrome & isIOS) {\r\n            this.setState({isAvailable: true});\r\n          }\r\n    }\r\n\r\n    /*\r\n     * Settings\r\n     */\r\n\r\n    openSettings = () => {\r\n        this.setState({ showSettings: true });\r\n    };\r\n\r\n    closeSettings = () => {\r\n        this.setState({ showSettings: false });\r\n    };\r\n\r\n    handleClick = (e) => {\r\n        const { showSettings } = this.state;\r\n        if (showSettings) {\r\n            let node = e.target;\r\n            let isModal = false;\r\n            while (node) {\r\n                if (\r\n                    node &&\r\n                    node.classList &&\r\n                    node.classList.contains(\"modal__el\")\r\n                ) {\r\n                    isModal = true;\r\n                    break;\r\n                }\r\n                node = node.parentNode;\r\n            }\r\n            if (!isModal) {\r\n                this.setState({ showSettings: false });\r\n            }\r\n        }\r\n    };\r\n\r\n    saveSettings = (\r\n        playbackURL,\r\n        currentAudioInputDevice,\r\n        currentAudioOutputDevice,\r\n        currentVideoInputDevice\r\n    ) => {\r\n        this.setState({\r\n            showSettings: false,\r\n            currentAudioInputDevice,\r\n            currentAudioOutputDevice,\r\n            currentVideoInputDevice,\r\n        });\r\n    };\r\n\r\n    setMetadataId = (metadataId) => {\r\n        this.setState({ metadataId });\r\n    };\r\n\r\n    setErrorMsg = (errorMsg) => {\r\n        this.setState({ errorMsg, showError: true });\r\n    };\r\n\r\n    closeError = () => {\r\n        this.setState({ showError: false });\r\n    };\r\n\r\n    endButtonOnClick = async () => {\r\n        await this.props.chime.leaveRoom(this.props.role === 'host');\r\n        sessionStorage.removeItem(this.props.ssName);\r\n        const whereTo = `${this.props.baseHref}/${this.props.role === 'host' ? '' : 'join?room=' + this.props.title}`;\r\n        this.props.history.push(whereTo);\r\n    }\r\n\r\n    layout = () => {\r\n        if (this.state.meetingStatus !== \"Success\") {\r\n            return;\r\n        }\r\n\r\n        return (\r\n            <div className=\"meeting-grid\" onClick={this.handleClick}>\r\n                <div className=\"meeting-header\">\r\n                    <img className=\"header-logo\" src={logo} alt=\"Logo\" />\r\n                    <div className=\"body-logo\">\r\n                        <span> SPONSORED BY: </span>\r\n                        <img src={bodylogo} alt=\"body logo\"/>\r\n                    </div>\r\n                </div>\r\n                <div className=\"main-body\">\r\n                    {this.state.showSettings && (\r\n                        <Settings\r\n                            chime={this.props.chime}\r\n                            joinInfo={this.joinInfo}\r\n                            saveSettings={this.saveSettings}\r\n                        />\r\n                    )}\r\n                    <div className=\"main-stage body-left\">\r\n                        <div className=\"body-before\">\r\n                            <div className=\"body-wrapper\">\r\n                                \r\n                                <LocalVideo\r\n                                    chime={this.props.chime}\r\n                                    joinInfo={this.joinInfo}\r\n                                />\r\n                                <div className=\"mobile-buttons\">\r\n                                    <button className=\"go-livebtn\" onClick={this.openSettings}>\r\n                                        <span className=\"txt-onbtn\">GO LIVE</span>\r\n                                    </button>\r\n                                    <button className=\"live-meetingbtn txt-onbtn\" onClick={this.endButtonOnClick}>\r\n                                        <span className=\"txt-onbtn\">LEAVE MEETING</span>\r\n                                    </button>\r\n                                </div>\r\n                                \r\n                                <div className=\"remote-cams\">\r\n                                    <RemoteVideoGroup\r\n                                        chime={this.props.chime}\r\n                                        joinInfo={this.joinInfo}\r\n                                    />\r\n                                </div>\r\n                                \r\n                            </div>\r\n                        </div>\r\n                        <div className=\"meeting-footer\">\r\n                            <Controls\r\n                                chime={this.props.chime}\r\n                                baseHref={this.baseHref}\r\n                                ssName={this.ssName}\r\n                                title={this.title}\r\n                                openSettings={this.openSettings}\r\n                                role={this.role}\r\n                                history={this.props.history}\r\n                                myVideoElement={this.myVideoElement}\r\n                                openChat={this.openChat}\r\n                                openPT={this.openPT}\r\n                                closeChat={this.hideModal}\r\n                                isOpenChat={this.state.showPopupMessage}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"right-sidebar\">\r\n                        {!this.state.showPopupMessage ? (\r\n                            \" \"\r\n                        ) : (\r\n                            <button className={\"btnPopdownMessage btnPopupMessageFont\"} onClick={this.hideModal}>\r\n                                <img src={vicon} alt=\"v right\" className={'vicon vright'}/>\r\n                            </button>\r\n                        )}\r\n                        {this.state.showPopupMessage ? (\r\n                            \" \"\r\n                        ) : (\r\n                            <button className={\"btnPopupMessage btnPopupMessageFont\"} onClick={this.showModal}>\r\n                                <img src={vicon} alt=\"v left\" className={'vicon vleft'}/>\r\n                                <span>Q&A/PARTICIPANTS</span>\r\n                            </button>\r\n                        )}\r\n                        {!this.state.showPopupMessage ? (\r\n                            \" \"\r\n                        ) : (\r\n                            <Chat\r\n                                chime={this.props.chime}\r\n                                title={this.title}\r\n                                username={this.username}\r\n                                joinInfo={this.joinInfo}\r\n                                closeChat={this.hideModal}\r\n                                isChat={this.state.isChat}\r\n                                changeTab={this.changeChat}\r\n                            />\r\n                        )}\r\n                        \r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const {isAvailable} = this.state;\r\n        return (\r\n            <React.Fragment>\r\n                {isAvailable && <Alert />}\r\n                <audio ref={this.audioElementRef} style={{ display: \"none\" }} />\r\n\r\n                {this.layout()}\r\n\r\n                {this.state.showError && (\r\n                    <Error\r\n                        closeError={this.closeError}\r\n                        errorMsg={this.state.errorMsg}\r\n                    />\r\n                )}\r\n            </React.Fragment>\r\n        );\r\n    }\r\n}\r\n\r\nMeeting.propTypes = {\r\n    chime: PropTypes.object,\r\n};\r\n\r\nexport default withRouter(Meeting);\r\n","import React, { Component } from 'react';\r\nimport { withRouter } from 'react-router-dom';\r\nimport * as config from '../../config';\r\n\r\nclass End extends Component {\r\n\r\n  constructor() {\r\n    super();\r\n    this.baseHref = config.BASE_HREF;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"welcome form-grid\">\r\n        <div className=\"welcome__intro\">\r\n          <div className=\"intro__inner formatted-text\">\r\n            <h1>Amazon IVS with ChimeSDK</h1>\r\n            <h3>Create or join rooms, and watch Amazon IVS streams with anyone.</h3>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"welcome__content pd-4\">\r\n          <div className=\"content__inner formatted-text\">\r\n            <h2 className=\"mg-b-2\">Room closed</h2>\r\n            <p>The host has ended the meeting and closed the room.</p>\r\n            <a href={`${this.baseHref}/`} className=\"mg-t-3 btn btn--primary\">Create a new room</a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(End);\r\n","import React from 'react';\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route\r\n} from \"react-router-dom\";\r\nimport * as config from '../config';\r\n// import './App.css';\r\n\r\nimport ChimeSdkWrapper from './chime/ChimeSdkWrapper';\r\n\r\nimport Home from './chimeWeb/Welcome';\r\nimport Join from './chimeWeb/Join';\r\nimport Meeting from './chimeWeb/Meeting';\r\nimport End from './chimeWeb/End';\r\n\r\nfunction App() {\r\n  const chime = new ChimeSdkWrapper();\r\n  const baseHref = config.BASE_HREF;\r\n\r\n  return (\r\n    <div className=\"App full-width full-height\">\r\n      <Router>\r\n        <Switch>\r\n          <Route path={`${baseHref}/end`}>\r\n            <End />\r\n          </Route>\r\n          <Route path={`${baseHref}/meeting`}>\r\n            <Meeting\r\n              chime={chime}\r\n            />\r\n          </Route>\r\n          <Route path={`${baseHref}/join`}>\r\n            <Join\r\n              chime={chime}\r\n            />\r\n          </Route>\r\n          <Route path={`${baseHref}`}>\r\n            <Home\r\n              chime={chime}\r\n            />\r\n          </Route>\r\n        </Switch>\r\n      </Router>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './components/App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n\r\nwindow.addEventListener('resize', () => {\r\n  // Update the element's size\r\n  let vh = window.innerHeight * 0.01;\r\n  document.documentElement.style.setProperty('--vh', `${vh}px`);\r\n  // alert(vh);\r\n});"],"sourceRoot":""}